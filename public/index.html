<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Health Tracker â€” All-in-One</title>

  <!-- Tailwind for styling -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Chart.js for graphs -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    body { background:#f1f5f9; font-family:sans-serif; }
    .card { background:#fff; padding:20px; margin:10px; border-radius:12px; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
    .hidden { display:none; }
    .nav { display:flex; gap:12px; }
    .nav span { cursor:pointer; padding:6px 12px; border-radius:8px; }
    .nav span.active { background:#48cae4; color:#000; font-weight:bold; }
    .topbar { display:flex; justify-content:space-between; align-items:center; margin-bottom:15px; }
    #habitList { list-style:none; padding:0; }
    #habitList li { display:flex; align-items:center; justify-content:space-between; padding:5px 0; }
    #habitList li .completed { text-decoration:line-through; color:gray; }
    .deleteBtn { background:none; border:none; color:red; cursor:pointer; font-size:16px; }
  </style>
</head>
<body>

<!-- ================= LOGIN PAGE ================= -->
<div id="loginPage" class="h-screen flex justify-center items-center">
  <div class="card w-96">
    <h2 class="text-xl font-bold mb-4">Login</h2>
    <input type="text" id="loginEmail" placeholder="Email" class="w-full mb-3 p-2 border rounded">
    <input type="password" id="loginPassword" placeholder="Password" class="w-full mb-3 p-2 border rounded">
    <button id="loginBtn" class="w-full bg-blue-500 text-white py-2 rounded">Login</button>
    <p class="mt-3 text-sm">Donâ€™t have an account? 
      <a href="#" id="toSignup" class="text-blue-600">Sign up</a>
    </p>
  </div>
</div>

<!-- ================= SIGNUP PAGE ================= -->
<div id="signupPage" class="h-screen flex justify-center items-center hidden">
  <div class="card w-96">
    <h2 class="text-xl font-bold mb-4">Sign Up</h2>
    <input type="text" id="signupName" placeholder="Name" class="w-full mb-3 p-2 border rounded">
    <input type="text" id="signupEmail" placeholder="Email" class="w-full mb-3 p-2 border rounded">
    <input type="password" id="signupPassword" placeholder="Password" class="w-full mb-3 p-2 border rounded">
    <button id="signupBtn" class="w-full bg-green-500 text-white py-2 rounded">Sign Up</button>
    <p class="mt-3 text-sm">Already have an account? 
      <a href="#" id="toLogin" class="text-blue-600">Login</a>
    </p>
  </div>
</div>

<!-- ================= DASHBOARD ================= -->
<div id="dashboardPage" class="hidden">
  <div class="card max-w-5xl mx-auto mt-6">
    <div class="topbar">
      <div class="nav">
        <span data-tab="overview" class="active">Dashboard</span>
        <span data-tab="habits">Habits</span>
        <span data-tab="workouts">Workouts</span>
        <span data-tab="meals">Meals</span>
        <span data-tab="sleep">Sleep</span>
        <span data-tab="mood">Mood</span>
        <span data-tab="friends">Friends</span>
      </div>
      <div>
        <span id="userInfo">Hi User</span> | 
        <button class="bg-red-500 text-white px-3 py-1 rounded" id="logoutBtn">Logout</button>
      </div>
    </div>

    <!-- Sections -->
    <div id="section-overview" class="dash-section">
      <h2 class="text-lg font-bold mb-2">Today Overview</h2>
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
        <div class="card"><strong>Habit Streak</strong><br>ðŸ”¥ 5 days</div>
        <div class="card"><strong>Workouts This Week</strong><br>3 sessions</div>
        <div class="card"><strong>Calories Today</strong><br>1200 kcal / 2000</div>
        <div class="card"><strong>Hydration</strong><br>6 glasses <button class="text-blue-600">+Add</button></div>
      </div>
    </div>

    <div id="section-habits" class="dash-section hidden">
      <h2 class="text-lg font-bold mb-2">Daily Habits</h2>
      <div class="card">
        <input type="text" id="habitInput" placeholder="Add new habit..." class="p-2 border rounded w-2/3">
        <button id="addHabitBtn" class="bg-blue-500 text-white px-3 py-1 rounded">Add</button>
        <ul id="habitList" class="mt-3"></ul>
      </div>
    </div>

    <div id="section-workouts" class="dash-section hidden">
      <h2 class="text-lg font-bold mb-2">Workouts</h2>
      <div class="card">
        <h3 class="font-semibold">Log New Workout</h3>
        <input type="text" placeholder="Workout type" class="w-full p-2 border rounded my-1">
        <input type="number" placeholder="Duration (minutes)" class="w-full p-2 border rounded my-1">
        <input type="number" placeholder="Calories burned" class="w-full p-2 border rounded my-1">
        <button class="bg-green-500 text-white px-3 py-1 rounded">Save Workout</button>
      </div>
    </div>

    <div id="section-meals" class="dash-section hidden">
      <h2 class="text-lg font-bold mb-2">Meals & Nutrition</h2>
      <div class="card">
        <h3 class="font-semibold">Log Meal</h3>
        <select class="w-full p-2 border rounded my-1">
          <option>Select meal type</option>
          <option>Breakfast</option>
          <option>Lunch</option>
          <option>Dinner</option>
          <option>Snack</option>
        </select>
        <input type="text" placeholder="Meal name" class="w-full p-2 border rounded my-1">
        <input type="number" placeholder="Calories" class="w-full p-2 border rounded my-1">
        <button class="bg-green-500 text-white px-3 py-1 rounded">Save Meal</button>
      </div>
    </div>

    <div id="section-sleep" class="dash-section hidden">
      <h2 class="text-lg font-bold mb-2">Sleep Tracking</h2>
      <div class="card">
        <label>Bedtime</label>
        <input type="time" class="w-full p-2 border rounded my-1">
        <label>Wake time</label>
        <input type="time" class="w-full p-2 border rounded my-1">
        <button class="bg-green-500 text-white px-3 py-1 rounded">Save Sleep</button>
      </div>
    </div>

    <div id="section-mood" class="dash-section hidden">
      <h2 class="text-lg font-bold mb-2">Mood Tracking</h2>
      <div class="card">ðŸ™‚ Feeling Happy today</div>
    </div>

    <div id="section-friends" class="dash-section hidden">
      <h2 class="text-lg font-bold mb-2">Friends</h2>
      <div class="card">Invite & connect with friends</div>
    </div>
  </div>
</div>

<script>
const API_URL = "http://localhost:10000"; // Backend URL

// Pages
const loginPage = document.getElementById("loginPage");
const signupPage = document.getElementById("signupPage");
const dashboardPage = document.getElementById("dashboardPage");

// Switch pages
document.getElementById("toSignup").onclick = () => { loginPage.classList.add("hidden"); signupPage.classList.remove("hidden"); }
document.getElementById("toLogin").onclick = () => { signupPage.classList.add("hidden"); loginPage.classList.remove("hidden"); }

// Signup
document.getElementById("signupBtn").onclick = async () => {
  const name = document.getElementById("signupName").value;
  const email = document.getElementById("signupEmail").value;
  const pass = document.getElementById("signupPassword").value;
  if(name && email && pass){
    const res = await fetch(`${API_URL}/register`, {
      method:"POST", headers:{"Content-Type":"application/json"},
      body: JSON.stringify({ username: email, password: pass })
    });
    const data = await res.json();
    if(data.error){ alert(data.error); }
    else { alert("Signup successful! Please login."); signupPage.classList.add("hidden"); loginPage.classList.remove("hidden"); }
  } else alert("Fill all fields");
};

// Login
document.getElementById("loginBtn").onclick = async () => {
  const email = document.getElementById("loginEmail").value;
  const pass = document.getElementById("loginPassword").value;
  const res = await fetch(`${API_URL}/login`, {
    method:"POST", headers:{"Content-Type":"application/json"},
    body: JSON.stringify({ username: email, password: pass })
  });
  const data = await res.json();
  if(data.error){ alert("Invalid credentials"); }
  else {
    localStorage.setItem("userId", data.userId);
    document.getElementById("userInfo").innerText = "Hi " + email;
    loginPage.classList.add("hidden");
    dashboardPage.classList.remove("hidden");
    loadDashboard();
  }
};

// Logout
document.getElementById("logoutBtn").onclick = () => {
  localStorage.removeItem("userId");
  dashboardPage.classList.add("hidden");
  loginPage.classList.remove("hidden");
};

// Dashboard nav
document.querySelectorAll(".nav span").forEach(tab => {
  tab.addEventListener("click", () => {
    document.querySelectorAll(".nav span").forEach(t => t.classList.remove("active"));
    tab.classList.add("active");
    document.querySelectorAll(".dash-section").forEach(sec => sec.classList.add("hidden"));
    document.getElementById("section-" + tab.getAttribute("data-tab")).classList.remove("hidden");
  });
});

// Load dashboard data
async function loadDashboard(){
  const userId = localStorage.getItem("userId");
  if(!userId) return;
  const res = await fetch(`${API_URL}/dashboard/${userId}`);
  const data = await res.json();
  console.log("Dashboard Data:", data);
}

// Auto-login
if(localStorage.getItem("userId")){
  loginPage.classList.add("hidden");
  dashboardPage.classList.remove("hidden");
  loadDashboard();
}
</script>

</body>
</html>
