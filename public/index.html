<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Health Tracker</title>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
  /* ===== Common Styles ===== */
  html, body { height:100%; margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI', Arial, sans-serif;}
  body {min-height:100vh; width:100vw; background:linear-gradient(120deg,#a2d4f6 60%,#023e8a 100%); overflow:hidden; display:flex; align-items:center; justify-content:center; position:relative;}
  body::before, body::after {content:""; position:absolute; border-radius:40% 60% 60% 40% / 60% 40% 60% 40%; opacity:0.33; z-index:0;}
  body::before {top:-100px; left:-100px; width:350px; height:350px; background:#90e0ef;}
  body::after {right:-120px; bottom:-160px; width:400px; height:300px; background:#0077b6;}
  .container {position:relative; z-index:1; width:100%; max-width:900px; margin:auto;}
  .card {background: rgba(255,255,255,0.14); box-shadow: 0 8px 32px 0 rgba(31,38,135,0.18); border-radius:22px; backdrop-filter:blur(14px); -webkit-backdrop-filter:blur(14px); padding:34px 32px 25px 32px; color:#fff; text-align:center; display:none;}
  .card.active {display:block;}
  .logo {font-size:1.1rem; font-weight:600; margin-bottom:17px; color:#fff;}
  h2 {margin:0 0 12px 0; letter-spacing:1px; font-size:2rem; font-weight:600;}
  label {display:block; text-align:left; margin:13px 0 3px 1px; font-size:1.04rem; color:#e0e0e0;}
  input[type="email"], input[type="password"] {width:100%; padding:10px 12px; border-radius:7px; border:none; margin-bottom:7px; background:rgba(255,255,255,0.27); color:#252525; font-size:1rem; outline:none;}
  input::placeholder {color:#bdbdbd;}
  .signin-btn {width:100%; padding:11px 0; background:#023e8a; color:#fff; font-weight:bold; border-radius:7px; border:none; font-size:1.07rem; cursor:pointer; margin-bottom:18px; transition: background 0.18s;}
  .signin-btn:hover {background:#0077b6;}
  .link {color:#48cae4; text-decoration:none; cursor:pointer;}
  .topbar {display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;}
  .nav {display:flex; gap:15px;}
  .nav span {cursor:pointer; padding:5px 10px; border-radius:6px; background:rgba(255,255,255,0.12);}
  #overviewCards {display:grid; grid-template-columns:repeat(4,1fr); gap:12px; margin-bottom:20px;}
  #overviewCards div {background: rgba(255,255,255,0.15); padding:15px; border-radius:12px; text-align:left;}
  #trends {display:grid; grid-template-columns:repeat(2,1fr); gap:15px; margin-bottom:20px;}
  #trends canvas {background:rgba(255,255,255,0.1); border-radius:12px; padding:10px;}
</style>
</head>
<body>

<div class="container">

  <!-- ===== Login Card ===== -->
  <div id="loginCard" class="card active">
    <div class="logo">Your logo</div>
    <h2>Login</h2>
    <form id="loginForm">
      <label for="loginEmail">Email</label>
      <input type="email" id="loginEmail" placeholder="username@gmail.com" required>
      <label for="loginPassword">Password</label>
      <input type="password" id="loginPassword" placeholder="Password" required>
      <button type="submit" class="signin-btn">Sign in</button>
    </form>
    <div class="register">Don't have an account? <span class="link" id="showSignup">Sign Up</span></div>
  </div>

  <!-- ===== Signup Card ===== -->
  <div id="signupCard" class="card">
    <div class="logo">Your logo</div>
    <h2>Sign Up</h2>
    <form id="signupForm">
      <label for="signupEmail">Email</label>
      <input type="email" id="signupEmail" placeholder="username@gmail.com" required>
      <label for="signupPassword">Password</label>
      <input type="password" id="signupPassword" placeholder="Password" required>
      <button type="submit" class="signin-btn">Sign Up</button>
    </form>
    <div class="register">Already have an account? <span class="link" id="showLogin">Login</span></div>
  </div>

  <!-- ===== Dashboard Card ===== -->
  <div id="dashboardCard" class="card">
    <div class="topbar">
      <div class="nav">
        <span>Dashboard</span>
        <span>Habits</span>
        <span>Workouts</span>
        <span>Meals</span>
        <span>Sleep</span>
        <span>Mood</span>
        <span>Friends</span>
      </div>
      <div>
        <span id="userInfo">Hi User</span> | <button class="signin-btn" id="logoutBtn">Logout</button>
      </div>
    </div>

    <h2>Today Overview</h2>
    <div id="overviewCards">
      <div><strong>Habit Streak</strong><br>ðŸ”¥ 5 days</div>
      <div><strong>Workouts This Week</strong><br>3 sessions</div>
      <div><strong>Calories Today</strong><br>1200 kcal / 2000</div>
      <div><strong>Hydration</strong><br>6 glasses <button>Add</button></div>
    </div>

    <h2>Trends (Last 7 Days)</h2>
    <div id="trends">
      <canvas id="caloriesChart"></canvas>
      <canvas id="workoutsChart"></canvas>
      <canvas id="mealsChart"></canvas>
      <canvas id="hydrationChart"></canvas>
    </div>

    <button class="signin-btn">Download Full Report</button>
  </div>

</div>

<script>
const API_URL = "https://health-tracker-exp.onrender.com";

// Elements
const loginCard = document.getElementById("loginCard");
const signupCard = document.getElementById("signupCard");
const dashboardCard = document.getElementById("dashboardCard");

const showSignup = document.getElementById("showSignup");
const showLogin = document.getElementById("showLogin");

const loginForm = document.getElementById("loginForm");
const signupForm = document.getElementById("signupForm");

const logoutBtn = document.getElementById("logoutBtn");

// ===== View Switch =====
showSignup.addEventListener("click", ()=>{ loginCard.classList.remove("active"); signupCard.classList.add("active"); });
showLogin.addEventListener("click", ()=>{ signupCard.classList.remove("active"); loginCard.classList.add("active"); });

// ===== Login =====
loginForm.addEventListener("submit", async (e)=>{
  e.preventDefault();
  const username = document.getElementById("loginEmail").value.trim();
  const password = document.getElementById("loginPassword").value.trim();
  try{
    const res = await fetch(`${API_URL}/login`, {
      method:"POST", headers:{"Content-Type":"application/json"}, body:JSON.stringify({username,password})
    });
    const data = await res.json();
    if(data.userId){
      localStorage.setItem("userId", data.userId);
      showDashboard();
    } else alert(data.error || "Login failed");
  }catch(err){ console.error(err); alert("Error connecting to backend"); }
});

// ===== Signup =====
signupForm.addEventListener("submit", async (e)=>{
  e.preventDefault();
  const username = document.getElementById("signupEmail").value.trim();
  const password = document.getElementById("signupPassword").value.trim();
  try{
    const res = await fetch(`${API_URL}/register`, {
      method:"POST", headers:{"Content-Type":"application/json"}, body:JSON.stringify({username,password})
    });
    const data = await res.json();
    if(data.message){
      alert("Signup successful!");
      signupCard.classList.remove("active");
      loginCard.classList.add("active");
    } else alert(data.error || "Signup failed");
  }catch(err){ console.error(err); alert("Error connecting to backend"); }
});

// ===== Dashboard =====
function showDashboard(){
  loginCard.classList.remove("active");
  signupCard.classList.remove("active");
  dashboardCard.classList.add("active");

  document.getElementById("userInfo").innerText = "User #" + localStorage.getItem("userId");

  // Fake chart data (replace with API later)
  const labels = ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];
  new Chart(document.getElementById("caloriesChart"), {
    type:"line",
    data:{ labels, datasets:[{label:"Calories", data:[1800,2000,1500,2200,2100,1900,1700], borderColor:"#48cae4"}]},
    options:{plugins:{legend:{labels:{color:"#fff"}}}, scales:{x:{ticks:{color:"#fff"}},y:{ticks:{color:"#fff"}}}}
  });
  new Chart(document.getElementById("workoutsChart"), {
    type:"bar",
    data:{ labels, datasets:[{label:"Workouts", data:[1,0,1,0,1,1,0], backgroundColor:"#0077b6"}]},
    options:{plugins:{legend:{labels:{color:"#fff"}}}, scales:{x:{ticks:{color:"#fff"}},y:{ticks:{color:"#fff"}}}}
  });
  new Chart(document.getElementById("mealsChart"), {
    type:"line",
    data:{ labels, datasets:[{label:"Meals Logged", data:[3,2,3,2,3,4,2], borderColor:"#90e0ef"}]},
    options:{plugins:{legend:{labels:{color:"#fff"}}}, scales:{x:{ticks:{color:"#fff"}},y:{ticks:{color:"#fff"}}}}
  });
  new Chart(document.getElementById("hydrationChart"), {
    type:"bar",
    data:{ labels, datasets:[{label:"Water (glasses)", data:[6,7,5,8,7,6,7], backgroundColor:"#023e8a"}]},
    options:{plugins:{legend:{labels:{color:"#fff"}}}, scales:{x:{ticks:{color:"#fff"}},y:{ticks:{color:"#fff"}}}}
  });
}

// ===== Logout =====
logoutBtn.addEventListener("click", ()=>{
  localStorage.removeItem("userId");
  dashboardCard.classList.remove("active");
  loginCard.classList.add("active");
});

// ===== Auto-login if user already logged in =====
if(localStorage.getItem("userId")) showDashboard();
</script>

</body>
</html>
